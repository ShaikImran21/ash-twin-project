<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Integration Test - Voyager</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .test-container {
            background: white;
            color: #333;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .subtitle {
            text-align: center;
            color: #999;
            margin-bottom: 40px;
        }
        
        .test-section {
            background: #f7fafc;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border-left: 5px solid #667eea;
        }
        
        .test-section h2 {
            color: #667eea;
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .status {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }
        
        .status.loading {
            background: #ffd700;
            color: #333;
        }
        
        .status.success {
            background: #4caf50;
            color: white;
        }
        
        .status.error {
            background: #f44336;
            color: white;
        }
        
        .result-box {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 20px;
            margin-top: 15px;
            font-size: 14px;
        }
        
        .result-item {
            padding: 10px;
            margin: 5px 0;
            background: #f8f9fa;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .result-value {
            font-weight: 600;
            color: #667eea;
        }
        
        .photo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .photo-item {
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .photo-item img {
            width: 100%;
            height: 150px;
            object-fit: cover;
        }
        
        .attraction-list {
            list-style: none;
            padding: 0;
        }
        
        .attraction-item {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .attraction-name {
            font-weight: 600;
            color: #667eea;
            margin-bottom: 5px;
        }
        
        .attraction-info {
            font-size: 13px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(102, 126, 234, 0.3);
            border-top-color: #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üß™ API Integration Test Dashboard</h1>
        <p class="subtitle">Testing Pexels, OpenTripMap, and Currency Conversion APIs</p>
        
        <!-- Currency Conversion Test -->
        <div class="test-section">
            <h2>
                üí∞ Currency Conversion (USD ‚Üí INR)
                <span class="status loading" id="currency-status">Testing...</span>
            </h2>
            <div class="result-box" id="currency-results">
                <div class="spinner"></div> Loading exchange rates...
            </div>
        </div>
        
        <!-- Pexels API Test -->
        <div class="test-section">
            <h2>
                üì∏ Pexels API - Travel Photos
                <span class="status loading" id="pexels-status">Testing...</span>
            </h2>
            <div class="result-box" id="pexels-results">
                <div class="spinner"></div> Fetching photos...
            </div>
        </div>
        
        <!-- OpenTripMap API Test -->
        <div class="test-section">
            <h2>
                üìç OpenTripMap - Nearby Attractions
                <span class="status loading" id="opentripmap-status">Testing...</span>
            </h2>
            <div class="result-box" id="opentripmap-results">
                <div class="spinner"></div> Loading attractions...
            </div>
        </div>
        
        <!-- Overall Status -->
        <div class="test-section" style="text-align: center; border-left-color: #4caf50;">
            <h2 style="justify-content: center;">
                ‚úÖ Test Summary
            </h2>
            <div id="summary" style="font-size: 18px; margin-top: 20px;">
                Running tests...
            </div>
        </div>
    </div>

    <script type="module">
        import { API_KEYS, API_ENDPOINTS } from './api-config-real.js';
        
        let testResults = {
            currency: false,
            pexels: false,
            opentripmap: false
        };
        
        // Test Currency Conversion
        async function testCurrencyConversion() {
            try {
                const response = await fetch('https://api.exchangerate-api.com/v4/latest/USD');
                const data = await response.json();
                
                if (data.rates && data.rates.INR) {
                    const rate = data.rates.INR;
                    const testAmounts = [1000, 1500, 2500];
                    
                    let html = '<h3 style="color: #4caf50; margin-top: 0;">‚úÖ Success!</h3>';
                    html += '<p>Current Exchange Rate: <strong>1 USD = ‚Çπ' + rate.toFixed(2) + '</strong></p>';
                    html += '<div style="margin-top: 15px;">';
                    
                    testAmounts.forEach(usd => {
                        const inr = Math.round(usd * rate);
                        const formatted = new Intl.NumberFormat('en-IN', {
                            style: 'currency',
                            currency: 'INR',
                            maximumFractionDigits: 0
                        }).format(inr);
                        
                        html += `
                            <div class="result-item">
                                <span>$${usd} USD</span>
                                <span class="result-value">${formatted}</span>
                            </div>
                        `;
                    });
                    
                    html += '</div>';
                    
                    document.getElementById('currency-results').innerHTML = html;
                    document.getElementById('currency-status').textContent = 'Success';
                    document.getElementById('currency-status').className = 'status success';
                    testResults.currency = true;
                } else {
                    throw new Error('Invalid response');
                }
            } catch (error) {
                document.getElementById('currency-results').innerHTML = 
                    '<p style="color: #f44336;">‚ùå Error: ' + error.message + '</p>';
                document.getElementById('currency-status').textContent = 'Failed';
                document.getElementById('currency-status').className = 'status error';
            }
            updateSummary();
        }
        
        // Test Pexels API
        async function testPexelsAPI() {
            try {
                const apiKey = API_KEYS.PEXELS;
                const response = await fetch(`https://api.pexels.com/v1/search?query=santorini greece travel&per_page=6&orientation=landscape`, {
                    headers: {
                        'Authorization': apiKey
                    }
                });
                
                const data = await response.json();
                
                if (data.photos && data.photos.length > 0) {
                    let html = '<h3 style="color: #4caf50; margin-top: 0;">‚úÖ Success!</h3>';
                    html += '<p>Found <strong>' + data.photos.length + '</strong> photos</p>';
                    html += '<div class="photo-grid">';
                    
                    data.photos.forEach(photo => {
                        html += `
                            <div class="photo-item">
                                <img src="${photo.src.medium}" alt="${photo.alt || 'Travel photo'}">
                                <div style="padding: 8px; font-size: 11px; background: #f8f9fa;">
                                    By ${photo.photographer}
                                </div>
                            </div>
                        `;
                    });
                    
                    html += '</div>';
                    
                    document.getElementById('pexels-results').innerHTML = html;
                    document.getElementById('pexels-status').textContent = 'Success';
                    document.getElementById('pexels-status').className = 'status success';
                    testResults.pexels = true;
                } else {
                    throw new Error('No photos found');
                }
            } catch (error) {
                document.getElementById('pexels-results').innerHTML = 
                    '<p style="color: #f44336;">‚ùå Error: ' + error.message + '</p>';
                document.getElementById('pexels-status').textContent = 'Failed';
                document.getElementById('pexels-status').className = 'status error';
            }
            updateSummary();
        }
        
        // Test OpenTripMap API
        async function testOpenTripMapAPI() {
            try {
                const apiKey = API_KEYS.OPENTRIPMAP;
                // Santorini coordinates
                const lat = 36.3932;
                const lon = 25.4615;
                
                const response = await fetch(
                    `https://api.opentripmap.com/0.1/en/places/radius?radius=5000&lon=${lon}&lat=${lat}&kinds=interesting_places,cultural,natural&limit=5&apikey=${apiKey}`
                );
                
                const data = await response.json();
                
                if (data.features && data.features.length > 0) {
                    let html = '<h3 style="color: #4caf50; margin-top: 0;">‚úÖ Success!</h3>';
                    html += '<p>Found <strong>' + data.features.length + '</strong> attractions near Santorini</p>';
                    html += '<ul class="attraction-list">';
                    
                    data.features.forEach(feature => {
                        const name = feature.properties.name || 'Unnamed Attraction';
                        const distance = (feature.properties.dist / 1000).toFixed(1);
                        const kinds = feature.properties.kinds || 'attraction';
                        
                        html += `
                            <li class="attraction-item">
                                <div class="attraction-name">${name}</div>
                                <div class="attraction-info">üìç ${distance} km away</div>
                                <div class="attraction-info">üè∑Ô∏è ${kinds}</div>
                            </li>
                        `;
                    });
                    
                    html += '</ul>';
                    
                    document.getElementById('opentripmap-results').innerHTML = html;
                    document.getElementById('opentripmap-status').textContent = 'Success';
                    document.getElementById('opentripmap-status').className = 'status success';
                    testResults.opentripmap = true;
                } else {
                    throw new Error('No attractions found');
                }
            } catch (error) {
                document.getElementById('opentripmap-results').innerHTML = 
                    '<p style="color: #f44336;">‚ùå Error: ' + error.message + '</p>';
                document.getElementById('opentripmap-status').textContent = 'Failed';
                document.getElementById('opentripmap-status').className = 'status error';
            }
            updateSummary();
        }
        
        // Update Summary
        function updateSummary() {
            const total = Object.keys(testResults).length;
            const passed = Object.values(testResults).filter(r => r).length;
            
            const summary = document.getElementById('summary');
            
            if (passed === total) {
                summary.innerHTML = `
                    <div style="font-size: 48px; margin-bottom: 15px;">üéâ</div>
                    <div style="color: #4caf50; font-weight: 600;">All ${total} API tests passed!</div>
                    <div style="margin-top: 15px; font-size: 16px; color: #666;">
                        Your website is ready with all API integrations working perfectly.
                    </div>
                `;
            } else if (passed > 0) {
                summary.innerHTML = `
                    <div style="font-size: 48px; margin-bottom: 15px;">‚ö†Ô∏è</div>
                    <div style="color: #ff9800; font-weight: 600;">${passed} out of ${total} tests passed</div>
                    <div style="margin-top: 15px; font-size: 16px; color: #666;">
                        Some APIs may need attention. Check the details above.
                    </div>
                `;
            }
        }
        
        // Run all tests
        testCurrencyConversion();
        testPexelsAPI();
        testOpenTripMapAPI();
    </script>
</body>
</html>
